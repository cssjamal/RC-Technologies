<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - RC Technologies</title>

    <!-- Same CSS files -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">

    <style>
        .checkout-container {
            padding-top: 120px;
            padding-bottom: 50px;
            min-height: 100vh;
            background: #f5f7fa;
        }
        
        .checkout-steps {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
            position: relative;
        }
        
        .checkout-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0 30px;
            position: relative;
            z-index: 1;
        }
        
        .step-number {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #ddd;
            color: #666;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 10px;
            transition: all 0.3s;
        }
        
        .checkout-step.active .step-number {
            background: var(--primary-color);
            color: white;
            box-shadow: 0 0 0 8px rgba(44, 62, 80, 0.1);
        }
        
        .checkout-step.completed .step-number {
            background: var(--secondary-color);
            color: white;
        }
        
        .step-label {
            font-weight: 600;
            color: #666;
        }
        
        .checkout-step.active .step-label {
            color: var(--primary-color);
        }
        
        .checkout-step.completed .step-label {
            color: var(--secondary-color);
        }
        
        .checkout-form-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .section-title {
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            flex: 1;
        }
        
        .form-control {
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .form-control:focus {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .karachi-areas {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 15px;
        }
        
        .area-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .area-checkbox:hover {
            border-color: var(--accent-color);
        }
        
        .area-checkbox.selected {
            border-color: var(--secondary-color);
            background: rgba(231, 76, 60, 0.05);
        }
        
        .area-checkbox input {
            display: none;
        }
        
        .order-summary-sidebar {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 140px;
        }
        
        .order-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        
        .payment-method-display {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .payment-icon-large {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }
        
        .jazzcash {
            background: #ff6b00;
        }
        
        .easypaisa {
            background: #00a859;
        }
        
        .cod {
            background: var(--primary-color);
        }
        
        .bank {
            background: #6f42c1;
        }
        
        .confirm-order-btn {
            background: linear-gradient(135deg, var(--secondary-color), #ff6b00);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            width: 100%;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .confirm-order-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.3);
        }
        
        .whatsapp-order-btn {
            background: #25D366;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 10px;
            font-weight: 600;
            width: 100%;
            margin-top: 15px;
            cursor: pointer;
        }
        
        @media (max-width: 768px) {
            .checkout-steps {
                flex-direction: column;
                align-items: center;
                gap: 20px;
            }
            .form-row {
                flex-direction: column;
                gap: 15px;
            }
            .karachi-areas {
                grid-template-columns: repeat(2, 1fr);
            }
            .order-summary-sidebar {
                position: static;
                margin-top: 30px;
            }
        }
    </style>
</head>

<body>
    <!-- Same Header -->
    <header>
        <!-- Same header code as cart.html -->
    </header>

    <!-- ========== CHECKOUT PROCESS ========== -->
    <div class="checkout-container">
        <div class="container">
            <!-- Checkout Steps -->
            <div class="checkout-steps">
                <div class="checkout-step active">
                    <div class="step-number">1</div>
                    <div class="step-label">Information</div>
                </div>
                <div class="checkout-step">
                    <div class="step-number">2</div>
                    <div class="step-label">Shipping</div>
                </div>
                <div class="checkout-step">
                    <div class="step-number">3</div>
                    <div class="step-label">Payment</div>
                </div>
                <div class="checkout-step">
                    <div class="step-number">4</div>
                    <div class="step-label">Confirm</div>
                </div>
            </div>

            <div class="row">
                <!-- Left Column: Checkout Form -->
                <div class="col-lg-8">
                    <!-- Step 1: Customer Information -->
                    <div id="step1" class="checkout-form-section">
                        <h3 class="section-title">
                            <i class="fas fa-user"></i> Customer Information
                        </h3>

                        <form id="customerInfoForm">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>First Name *</label>
                                    <input type="text" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label>Last Name *</label>
                                    <input type="text" class="form-control" required>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label>Email Address *</label>
                                    <input type="email" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <label>Phone Number *</label>
                                    <div class="d-flex gap-2">
                                        <select class="form-control" style="width: 100px;">
                                            <option>+92</option>
                                        </select>
                                        <input type="tel" class="form-control" placeholder="300 1234567" required>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label>Alternate Phone (Optional)</label>
                                <input type="tel" class="form-control" placeholder="For delivery updates">
                            </div>

                            <div class="d-flex justify-content-end">
                                <button type="button" class="btn btn-primary" onclick="nextStep(2)">
                                    Continue to Shipping <i class="fas fa-arrow-right"></i>
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Step 2: Shipping Address -->
                    <div id="step2" class="checkout-form-section" style="display: none;">
                        <h3 class="section-title">
                            <i class="fas fa-map-marker-alt"></i> Shipping Address
                        </h3>

                        <div class="form-group">
                            <label>Complete Address *</label>
                            <textarea class="form-control" rows="3" placeholder="House #, Street, Area, Landmark" required></textarea>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>City *</label>
                                <input type="text" class="form-control" value="Karachi" readonly>
                            </div>
                            <div class="form-group">
                                <label>Area / Sector *</label>
                                <input type="text" class="form-control" placeholder="Gulshan, Clifton, etc." required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Select Service Areas in Karachi</label>
                            <div class="karachi-areas">
                                <label class="area-checkbox">
                                    <input type="checkbox" name="area" value="Gulshan">
                                    <span>Gulshan</span>
                                </label>
                                <label class="area-checkbox">
                                    <input type="checkbox" name="area" value="Clifton">
                                    <span>Clifton</span>
                                </label>
                                <label class="area-checkbox">
                                    <input type="checkbox" name="area" value="DHA">
                                    <span>DHA</span>
                                </label>
                                <label class="area-checkbox">
                                    <input type="checkbox" name="area" value="North Nazimabad">
                                    <span>N. Nazimabad</span>
                                </label>
                                <label class="area-checkbox">
                                    <input type="checkbox" name="area" value="Gulistan-e-Johar">
                                    <span>Gulistan-e-Johar</span>
                                </label>
                                <label class="area-checkbox">
                                    <input type="checkbox" name="area" value="Korangi">
                                    <span>Korangi</span>
                                </label>
                                <label class="area-checkbox">
                                    <input type="checkbox" name="area" value="Malir">
                                    <span>Malir</span>
                                </label>
                                <label class="area-checkbox">
                                    <input type="checkbox" name="area" value="Saddar">
                                    <span>Saddar</span>
                                </label>
                                <label class="area-checkbox">
                                    <input type="checkbox" name="area" value="Other">
                                    <span>Other Area</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Special Instructions (Optional)</label>
                            <textarea class="form-control" rows="2" placeholder="Delivery timing, gate code, etc."></textarea>
                        </div>

                        <div class="d-flex justify-content-between">
                            <button type="button" class="btn btn-outline-primary" onclick="prevStep(1)">
                                <i class="fas fa-arrow-left"></i> Back
                            </button>
                            <button type="button" class="btn btn-primary" onclick="nextStep(3)">
                                Continue to Payment <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Step 3: Payment Method -->
                    <div id="step3" class="checkout-form-section" style="display: none;">
                        <h3 class="section-title">
                            <i class="fas fa-credit-card"></i> Payment Method
                        </h3>

                        <!-- Selected Payment Display -->
                        <div class="payment-method-display" id="paymentDisplay">
                            <!-- Dynamically filled by JavaScript -->
                        </div>

                        <!-- JazzCash/EasyPaisa Details -->
                        <div id="mobilePaymentDetails" style="display: none;">
                            <h5>Mobile Payment Instructions</h5>
                            <div class="alert alert-info">
                                <p><strong>Step 1:</strong> Send payment to following number:</p>
                                <p><strong>JazzCash:</strong> 0300-1234567</p>
                                <p><strong>EasyPaisa:</strong> 0345-1234567</p>
                                <p><strong>Step 2:</strong> Enter transaction ID below:</p>
                                <input type="text" class="form-control mt-2" placeholder="Transaction ID" id="transactionId">
                            </div>
                        </div>

                        <!-- Bank Transfer Details -->
                        <div id="bankPaymentDetails" style="display: none;">
                            <h5>Bank Transfer Details</h5>
                            <div class="alert alert-info">
                                <p><strong>Bank:</strong> Habib Bank Limited</p>
                                <p><strong>Account Title:</strong> RC Technologies</p>
                                <p><strong>Account Number:</strong> 1234-5678901-2</p>
                                <p><strong>IBAN:</strong> PK36HABB0012345678901234</p>
                                <p><strong>Branch:</strong> Gulshan Branch, Karachi</p>
                                <p>Upload payment proof after transfer:</p>
                                <input type="file" class="form-control mt-2" accept="image/*,.pdf">
                            </div>
                        </div>

                        <!-- COD Note -->
                        <div id="codDetails">
                            <div class="alert alert-success">
                                <i class="fas fa-info-circle"></i>
                                <strong>Cash on Delivery Available:</strong> Pay when you receive your order. Delivery charges apply.
                            </div>
                        </div>

                        <div class="d-flex justify-content-between">
                            <button type="button" class="btn btn-outline-primary" onclick="prevStep(2)">
                                <i class="fas fa-arrow-left"></i> Back
                            </button>
                            <button type="button" class="btn btn-primary" onclick="nextStep(4)">
                                Review Order <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Step 4: Order Review -->
                    <div id="step4" class="checkout-form-section" style="display: none;">
                        <h3 class="section-title">
                            <i class="fas fa-clipboard-check"></i> Order Review
                        </h3>

                        <!-- Order Summary -->
                        <div class="alert alert-primary">
                            <h5><i class="fas fa-check-circle"></i> Order Ready for Confirmation</h5>
                            <p class="mb-0">Please review all details before confirming your order.</p>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <h6>Customer Details</h6>
                                <p id="reviewCustomer">Loading...</p>
                            </div>
                            <div class="col-md-6">
                                <h6>Shipping Address</h6>
                                <p id="reviewAddress">Loading...</p>
                            </div>
                        </div>

                        <div class="mt-4">
                            <h6>Order Items</h6>
                            <div id="reviewItems">
                                <!-- Items will be loaded by JavaScript -->
                            </div>
                        </div>

                        <div class="mt-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="termsAgree" required>
                                <label class="form-check-label" for="termsAgree">
                                    I agree to the <a href="#">Terms & Conditions</a> and confirm that all information provided is correct.
                                </label>
                            </div>
                        </div>

                        <div class="d-flex justify-content-between mt-4">
                            <button type="button" class="btn btn-outline-primary" onclick="prevStep(3)">
                                <i class="fas fa-arrow-left"></i> Back to Payment
                            </button>
                            <button type="button" class="btn btn-success" onclick="confirmOrder()">
                                <i class="fas fa-check-circle"></i> Confirm Order
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Right Column: Order Summary -->
                <div class="col-lg-4">
                    <div class="order-summary-sidebar">
                        <h4 class="mb-4">Order Summary</h4>

                        <!-- Order Items -->
                        <div id="sidebarItems">
                            <!-- Items loaded by JavaScript -->
                        </div>

                        <!-- Order Total -->
                        <div class="mt-4">
                            <div class="order-item">
                                <span>Subtotal</span>
                                <span id="sidebarSubtotal">Rs 0</span>
                            </div>
                            <div class="order-item">
                                <span>Delivery</span>
                                <span id="sidebarDelivery">Rs 0</span>
                            </div>
                            <div class="order-item">
                                <span>Tax</span>
                                <span id="sidebarTax">Rs 0</span>
                            </div>
                            <div class="order-item">
                                <span>Discount</span>
                                <span class="text-success" id="sidebarDiscount">Rs 0</span>
                            </div>
                            <div class="order-item" style="font-size: 1.2rem; font-weight: 700; border-top: 2px solid #333;">
                                <span>Total</span>
                                <span id="sidebarTotal">Rs 0</span>
                            </div>
                        </div>

                        <!-- Selected Payment -->
                        <div class="payment-method-display mt-4">
                            <div class="payment-icon-large cod" id="sidebarPaymentIcon">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <div>
                                <h6 id="sidebarPaymentMethod">Cash on Delivery</h6>
                                <small>Pay when received</small>
                            </div>
                        </div>

                        <!-- Confirm Order Button -->
                        <button class="confirm-order-btn mt-4" onclick="confirmOrder()">
                            <i class="fas fa-lock"></i> Confirm & Place Order
                        </button>

                        <!-- WhatsApp Order Option -->
                        <button class="whatsapp-order-btn" onclick="orderViaWhatsApp()">
                            <i class="fab fa-whatsapp"></i> Order via WhatsApp
                        </button>

                        <!-- Need Help -->
                        <div class="text-center mt-4">
                            <small class="text-muted">
                                <i class="fas fa-headset"></i> Need help? Call 021-1234567
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- ========== CHECKOUT END ========== -->

    <!-- Order Success Modal -->
    <div class="modal fade" id="orderSuccessModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header border-0">
                    <h5 class="modal-title">Order Placed Successfully!</h5>
                </div>
                <div class="modal-body text-center py-5">
                    <div class="mb-4">
                        <i class="fas fa-check-circle fa-5x text-success"></i>
                    </div>
                    <h4 class="mb-3">Thank You for Your Order!</h4>
                    <p class="text-muted mb-4">Your order has been received and is being processed.</p>

                    <div class="alert alert-info text-start">
                        <h6><i class="fas fa-info-circle"></i> Order Details:</h6>
                        <p class="mb-1"><strong>Order ID:</strong> <span id="modalOrderId">RC20231215001</span></p>
                        <p class="mb-1"><strong>Total Amount:</strong> <span id="modalOrderTotal">Rs 39,485</span></p>
                        <p class="mb-0"><strong>Estimated Delivery:</strong> 2-3 business days</p>
                    </div>

                    <div class="mt-4">
                        <p>You will receive order confirmation on your email and WhatsApp.</p>
                    </div>
                </div>
                <div class="modal-footer border-0 justify-content-center">
                    <button type="button" class="btn btn-primary" onclick="viewOrderDetails()">
                        <i class="fas fa-eye"></i> View Order Details
                    </button>
                    <button type="button" class="btn btn-outline-primary" data-bs-dismiss="modal">
                        Continue Shopping
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Same Footer -->
    <footer class="footer bg-dark text-white pt-5">
        <!-- Same footer code -->
    </footer>

    <!-- ========== SCRIPTS ========== -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Current step
        let currentStep = 1;
        let orderData = {
            customer: {},
            shipping: {},
            payment: 'cod',
            items: [],
            total: 0
        };

        // Initialize from localStorage
        document.addEventListener('DOMContentLoaded', function() {
            loadCartData();
            updateOrderSummary();
            setupAreaCheckboxes();
        });

        // Load cart data from localStorage
        function loadCartData() {
            const savedCart = localStorage.getItem('cart');
            const savedPayment = localStorage.getItem('selectedPayment');
            const savedCoupon = localStorage.getItem('couponApplied');

            if (savedCart) {
                orderData.items = JSON.parse(savedCart);
                orderData.payment = savedPayment || 'cod';
                couponApplied = savedCoupon === 'true';
            }

            // Update payment display
            updatePaymentDisplay();
        }

        // Step Navigation
        function nextStep(step) {
            // Validate current step
            if (currentStep === 1 && !validateStep1()) return;
            if (currentStep === 2 && !validateStep2()) return;
            if (currentStep === 3 && !validateStep3()) return;

            // Hide current step
            document.getElementById(`step${currentStep}`).style.display = 'none';
            document.querySelectorAll('.checkout-step')[currentStep - 1].classList.remove('active');

            // Show next step
            currentStep = step;
            document.getElementById(`step${step}`).style.display = 'block';
            document.querySelectorAll('.checkout-step')[step - 1].classList.add('active');

            // Mark previous steps as completed
            for (let i = 0; i < step - 1; i++) {
                document.querySelectorAll('.checkout-step')[i].classList.add('completed');
            }

            // Update order data
            if (step === 4) {
                updateOrderReview();
            }
        }

        function prevStep(step) {
            document.getElementById(`step${currentStep}`).style.display = 'none';
            document.querySelectorAll('.checkout-step')[currentStep - 1].classList.remove('active');

            currentStep = step;
            document.getElementById(`step${step}`).style.display = 'block';
            document.querySelectorAll('.checkout-step')[step - 1].classList.add('active');
        }

        // Step Validations
        function validateStep1() {
            const form = document.getElementById('customerInfoForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return false;
            }

            // Save customer data
            orderData.customer = {
                firstName: form.querySelector('input[type="text"]').value,
                lastName: form.querySelectorAll('input[type="text"]')[1].value,
                email: form.querySelector('input[type="email"]').value,
                phone: form.querySelector('input[type="tel"]').value
            };

            return true;
        }

        function validateStep2() {
            // Save shipping data
            orderData.shipping = {
                address: document.querySelector('#step2 textarea').value,
                area: document.querySelector('#step2 input[placeholder*="Area"]').value,
                instructions: document.querySelectorAll('#step2 textarea')[1] ? .value || ''
            };

            return true;
        }

        function validateStep3() {
            // Payment validation
            if (orderData.payment === 'jazzcash' || orderData.payment === 'easypaisa') {
                const transactionId = document.getElementById('transactionId').value;
                if (!transactionId.trim()) {
                    alert('Please enter your transaction ID');
                    return false;
                }
                orderData.transactionId = transactionId;
            }

            return true;
        }

        // Setup Karachi Areas Checkboxes
        function setupAreaCheckboxes() {
            document.querySelectorAll('.area-checkbox').forEach(checkbox => {
                checkbox.addEventListener('click', function() {
                    this.classList.toggle('selected');
                    const input = this.querySelector('input');
                    input.checked = !input.checked;
                });
            });
        }

        // Update Payment Display
        function updatePaymentDisplay() {
            const paymentMethods = {
                'jazzcash': {
                    name: 'JazzCash',
                    icon: 'fas fa-mobile-alt',
                    class: 'jazzcash'
                },
                'easypaisa': {
                    name: 'EasyPaisa',
                    icon: 'fas fa-wallet',
                    class: 'easypaisa'
                },
                'cod': {
                    name: 'Cash on Delivery',
                    icon: 'fas fa-money-bill-wave',
                    class: 'cod'
                },
                'bank': {
                    name: 'Bank Transfer',
                    icon: 'fas fa-university',
                    class: 'bank'
                }
            };

            const method = paymentMethods[orderData.payment];

            // Update main display
            const display = document.getElementById('paymentDisplay');
            display.innerHTML = `
                <div class="payment-icon-large ${method.class}">
                    <i class="${method.icon}"></i>
                </div>
                <div>
                    <h5>${method.name}</h5>
                    <small>Selected Payment Method</small>
                </div>
            `;

            // Update sidebar
            document.getElementById('sidebarPaymentMethod').textContent = method.name;
            const sidebarIcon = document.getElementById('sidebarPaymentIcon');
            sidebarIcon.className = `payment-icon-large ${method.class}`;
            sidebarIcon.innerHTML = `<i class="${method.icon}"></i>`;

            // Show/hide payment details
            document.getElementById('mobilePaymentDetails').style.display =
                (orderData.payment === 'jazzcash' || orderData.payment === 'easypaisa') ? 'block' : 'none';

            document.getElementById('bankPaymentDetails').style.display =
                orderData.payment === 'bank' ? 'block' : 'none';

            document.getElementById('codDetails').style.display =
                orderData.payment === 'cod' ? 'block' : 'none';
        }

        // Update Order Summary
        function updateOrderSummary() {
            if (orderData.items.length === 0) return;

            let subtotal = 0;
            let itemsHtml = '';

            orderData.items.forEach(item => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;

                itemsHtml += `
                    <div class="order-item">
                        <span>${item.name} Ã— ${item.quantity}</span>
                        <span>Rs ${itemTotal.toLocaleString()}</span>
                    </div>
                `;
            });

            const delivery = 500;
            const tax = subtotal * 0.13;
            const discount = couponApplied ? subtotal * 0.10 : 0;
            const total = subtotal + delivery + tax - discount;

            orderData.total = total;

            // Update sidebar
            document.getElementById('sidebarItems').innerHTML = itemsHtml;
            document.getElementById('sidebarSubtotal').textContent = 'Rs ' + subtotal.toLocaleString();
            document.getElementById('sidebarDelivery').textContent = 'Rs ' + delivery.toLocaleString();
            document.getElementById('sidebarTax').textContent = 'Rs ' + Math.round(tax).toLocaleString();
            document.getElementById('sidebarDiscount').textContent = 'Rs ' + Math.round(discount).toLocaleString();
            document.getElementById('sidebarTotal').textContent = 'Rs ' + Math.round(total).toLocaleString();
        }

        // Update Order Review
        function updateOrderReview() {
            // Customer details
            document.getElementById('reviewCustomer').innerHTML = `
                ${orderData.customer.firstName} ${orderData.customer.lastName}<br>
                ${orderData.customer.email}<br>
                ${orderData.customer.phone}
            `;

            // Shipping address
            document.getElementById('reviewAddress').innerHTML = `
                ${orderData.shipping.address}<br>
                ${orderData.shipping.area}, Karachi<br>
                ${orderData.shipping.instructions ? '<small class="text-muted">' + orderData.shipping.instructions + '</small>' : ''}
            `;

            // Order items
            let itemsHtml = '';
            orderData.items.forEach(item => {
                itemsHtml += `
                    <div class="d-flex justify-content-between border-bottom py-2">
                        <div>
                            <strong>${item.name}</strong><br>
                            <small class="text-muted">Quantity: ${item.quantity}</small>
                        </div>
                        <div>Rs ${(item.price * item.quantity).toLocaleString()}</div>
                    </div>
                `;
            });
            document.getElementById('reviewItems').innerHTML = itemsHtml;
        }

        // Confirm Order
        function confirmOrder() {
            if (!document.getElementById('termsAgree').checked) {
                alert('Please agree to the Terms & Conditions');
                return;
            }

            // Generate order ID
            const orderId = 'RC' + new Date().getFullYear() +
                String(new Date().getMonth() + 1).padStart(2, '0') +
                String(new Date().getDate()).padStart(2, '0') +
                String(Math.floor(Math.random() * 1000)).padStart(3, '0');

            // Save order to localStorage (simulating database)
            const order = {
                id: orderId,
                date: new Date().toISOString(),
                status: 'pending',
                ...orderData
            };

            let orders = JSON.parse(localStorage.getItem('orders') || '[]');
            orders.push(order);
            localStorage.setItem('orders', JSON.stringify(orders));

            // Clear cart
            localStorage.removeItem('cart');

            // Show success modal
            document.getElementById('modalOrderId').textContent = orderId;
            document.getElementById('modalOrderTotal').textContent = 'Rs ' + Math.round(orderData.total).toLocaleString();

            const modal = new bootstrap.Modal(document.getElementById('orderSuccessModal'));
            modal.show();
        }

        // Order via WhatsApp
        function orderViaWhatsApp() {
            let message = `*New Order Request - RC Technologies*\n\n`;
            message += `*Customer:* ${orderData.customer.firstName} ${orderData.customer.lastName}\n`;
            message += `*Phone:* ${orderData.customer.phone}\n`;
            message += `*Address:* ${orderData.shipping.address}\n\n`;
            message += `*Order Items:*\n`;

            orderData.items.forEach(item => {
                message += `- ${item.name} (Qty: ${item.quantity}) - Rs ${item.price * item.quantity}\n`;
            });

            message += `\n*Total:* Rs ${Math.round(orderData.total).toLocaleString()}\n`;
            message += `*Payment:* ${orderData.payment.toUpperCase()}`;

            const whatsappUrl = `https://wa.me/923001234567?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }

        // View Order Details
        function viewOrderDetails() {
            // In real system, redirect to order details page
            window.location.href = 'user-orders.html';
        }
    </script>
</body>

</html>